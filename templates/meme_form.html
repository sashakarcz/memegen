<!DOCTYPE html>
<html lang="en">
<head>
    <title>Create a Meme</title>
    <!-- Material Design CSS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <!-- Material Design CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-lite/1.3.0/material.indigo-pink.min.css">
    <!-- Material Design JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/material-design-lite/1.3.0/material.min.js"></script>
    </head>
    <script>
    function updatePreview() {
      let template = document.getElementById("template").value;
      let topText = document.getElementById("top").value.trim();
      let bottomText = document.getElementById("bottom").value.trim();

      // Replace spaces with underscores
      topText = topText ? encodeURIComponent(topText.replace(/ /g, "_")) : "_";
      bottomText = bottomText ? encodeURIComponent(bottomText.replace(/ /g, "_")) : "_";

      // Use Fiber Proxy instead of calling localhost:5002 directly
      let previewUrl = `/api/images/${template}/${topText}/${bottomText}.png`;
      document.getElementById("memePreview").src = previewUrl;
    }
</script>
<body>
    <h1>Create a Meme</h1>
    <form action="/generate" method="post">
        <label>Template:</label>
        <select id="template" name="template" onchange="updatePreview()">
            {{range .}}
            <option value="{{.ID}}">{{.Name}}</option>
            {{end}}
        </select>
        <br>
        <label>Top Text:</label>
        <input type="text" id="top" name="top" oninput="updatePreview()">
        <br>
        <label>Bottom Text:</label>
        <input type="text" id="bottom" name="bottom" oninput="updatePreview()">
        <br>

        <h3>Preview:</h3>
        <img id="memePreview" src="" alt="Meme Preview" style="max-width: 100%; border: 2px solid #ddd; border-radius: 5px; padding: 10px;">
        <br>
        <button type="submit">Generate Meme</button>
    </form>
</body>
</html>

